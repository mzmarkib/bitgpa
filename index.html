<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>GPA Calculator - BIT (UCSC)</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    
    <header class="header">
        <div>Grade Point Average Calculator</div>
        <div>BIT-UCSC</div>
    </header>
    <footer></footer>
    <main>
        <section id="home" class="page home">
            <form id="gpaForm">
                
            </form>
        </section>
        <section class="page faq">
            <div class="container">
                <div class="pageTitle">FAQ</div>
                <div class="pageDesc">Deals with a few questions that are frequently arise in students and are not sometimes answered.If you have any further questions you can ask them via the details in the contact page. We hope they are helpful...</div>
                <div class="faq-touple">
                    <div class="question">How many times can I repeat a subject?</div>
                    <div class="answer">You can have upto Three(3) attempts on a particular subject.</div>
                </div>
                <div class="faq-touple">
                    <div class="question">What is the highest grade that can I get when I attempt a particular subject for the second time?</div>
                    <div class="answer">You can obatain any grade upto an A, <strong>but</strong> when accounting the Grade Point Value (GPV) for that particular subject can be upto 2.00 (GPV of a C grade).</div>
                </div>
                <div class="faq-touple">
                    <div class="question">What is the Difference between an A grade and an A+ grade</div>
                    <div class="answer">Both A and A+ grades carries the same Grade Point Value (GPV) values of 4.00, <strong>but</strong> When calculating GPA for class awarding, and A+ will be given a Grade Point Value (GPV) of 4.25.</div>
                </div>
                <div class="faq-touple">
                    <div class="question">If I applied for a particular Exam and did not attend the exam, will it still count as an Attempt?</div>
                    <div class="answer">No, If you are absent for an absent for an exam it will be counted as NOT SAT. On the other hand you are expected to produce a Medical for your absence.</div>
                </div>
                <div class="faq-touple">
                    <div class="question">What is a Credit?</div>
                    <div class="answer">It is the measure of how much content a particular subject carries. A credit is equal to 15 hours of lectures or 30-45 hours of practical or an equivalent combination of lectures.</div>
                </div>                
            </div>
        </section>
        <section class="page about">
            <div class="container">
                <div class="pageTitle">About</div>
                <div class="pageDesc">
                    <p>This App is was created on the sole purpose of "Practice", it might change, but not yet. And also I built this app because I think that there was no GPA Calculator that can calculate the GPA <strong>
                        cumulatively</strong>  Hopefuly it might help me or someone following BIT-UCSC.</p>
                    <p>This Web App was created using only pure HTML, CSS and JavaScript. No Frameworks or Libraries were used during the process. No... not even jQuery!</p>
                    <p>Enough about the app, lets' take a look at some info that you might need.</p>
                </div>
                <section>
                    <h1>Calculation of Grade Point Average</h1>
                    <p>Grade Point Values associated with each grade are as shown in the Table 1. These GPV values are used to compute GPA as using the following formulae:</p>
                    <img src="img/gpa-calculation.png" alt="bit-gpa-calculation-formulae">
                </section>
                
                <section>
                    <h1>Grade Point Values (GPV)</h1>
                    <p>The Grade you score has a particular value of Grade Point Value. It is used to calculated during the GPA calculation process. They are as given in Table 1.</p>
                    <table> <tbody> <tr> <td><strong>Range of Score</strong></td><td><strong>Grade</strong></td><td><strong>GPV</strong></td><td><strong>Attainment</strong></td></tr><tr> <td>90 &ndash;&nbsp;100</td><td>A+</td><td>4.00<a href="#"> [1]</a></td><td rowspan="3">Superior</td></tr><tr> <td>80 &ndash;&nbsp;89</td><td>A</td><td>4.00</td></tr><tr> <td>75 &ndash;&nbsp;79</td><td>A-</td><td>3.75</td></tr><tr> <td>70 &ndash;&nbsp;74</td><td>B+</td><td>3.25</td><td rowspan="3">Meritorious</td></tr><tr> <td>65 &ndash;&nbsp;69</td><td>B</td><td>3.00</td></tr><tr> <td>60 &ndash;&nbsp;64</td><td>B-</td><td>2.75</td></tr><tr> <td>55 &ndash; 59</td><td>C+</td><td>2.25</td><td rowspan="3">Adequate</td></tr><tr> <td>50 &ndash;&nbsp;54</td><td>C</td><td>2.00</td></tr><tr> <td>45 &ndash;&nbsp;49</td><td>C-</td><td>1.75</td></tr><tr> <td>40 &ndash;&nbsp;44</td><td>D+</td><td>1.25</td><td rowspan="3">Minimal</td></tr><tr> <td>30 &ndash; 39</td><td>D</td><td>1.00</td></tr><tr> <td>20 &ndash;&nbsp;29</td><td>D-</td><td>0.75</td></tr><tr> <td>00 &ndash; 19</td><td>E</td><td>0.00</td><td>Failure</td></tr></tbody><caption align="bottom">Table 1 - GPV values for associated Grades</caption></table>
                    <p><a href="#">[1]</a> When calculating classes, A+ will be given a Grade Point Value of 4.25</p>
                </section>
                <section>
                    <h1>Award of Honours and Classes</h1>
                    <p>A Student qualifying for the award of a degree general (3 year) by completing all the relevant requirements shall also be qualified for the award of a class as follows.</p>
                    <p class="indent">(a). First Class for obtaining a minimum overall GPA of 3.50</p>
                    <p class="indent">(b). Second Class (Upper Division) – for obtaining a minimum overall GPA of 3.25</p>
                    <p class="indent">(c). Second Class (Lower Division) – for obtaining a minimum overall GPA of 3.00</p>
                </section>
            </div>
        </section>
        <section class="page contact">
            <div class="container">
                <div class="pageTitle">Contact</div>
                <div class="dp">
                    <!-- <img src="img/dp_plain.jpg" alt="@mzmarkib"> -->
                </div>
                <div class="cname">M. Z. Mohammed Arkib</div>

                <div class="chandle">@mzmarkib</div>

                <div class="pageDesc">
                    <p>You find me on any Social Media using the handle <a href="https://www.google.com/search?q=%40mzmarkib" target="_blank">@mzmarkib</a></p>
                </div>

                
                
            </div>
        </section>
    </main>    
    
    
    
    <!-- Grades Dialog Box HTML start -->
    <div class="dialogOverlay">        
    </div>
    <div class="gradesPrompt">
        <div class="innerBox">
            <div class="promptHeader">
            Select your Grade: <span class="promptClose">X</span>
            </div>
            <div class="promptBody">
                <div class="grades">
                <div data_gpv="4" class="green grade">A+</div>
                <div data_gpv="4" class="green grade">A</div>
                <div data_gpv="3.75" class="green grade">A-</div>
                <div data_gpv="3.25" class="orange grade">B+</div>
                <div data_gpv="3" class="orange grade">B</div>
                <div data_gpv="2.75" class="orange grade">B-</div>
                <div data_gpv="2.25" class="orangered grade">C+</div>
                <div data_gpv="2" class="orangered grade">C</div>
                <div data_gpv="1.75" class="orangered grade">C-</div>
                <div data_gpv="1.25" class="red grade">D+</div>
                <div data_gpv="1" class="red grade">D</div>
                <div data_gpv="0.75" class="red grade">D-</div>
                <div data_gpv="0" class="darkred grade">E</div>
                <div data_gpv="-1" class="grade">NOT SAT</div>
                </div>
            </div>
        </div>
    </div>         
    <!-- Grades Dialog Box HTML end -->


    <nav class="navbar">
        <div class="container">
            <div name="home" class="item active">
                <div name="home"><img src="img/icons/home1.png"></div>
                <div>Home</div>
            </div>
            <div name="faq" class="item">
                <div name="home"><img src="img/icons/faq2.png"></div>
                <div>FAQ</div>
            </div> 
            <div name="calc" class="item cta_calc">
                <div><img src="img/icons/dash1.png"></div>
            </div> 
            <div name="about" class="item">
                <div name="home"><img src="img/icons/info3.png"></div>
                <div>About</div>
            </div> 
            <div name="contact" class="item">
                <div name="home"><img src="img/icons/info2.png"></div>
                <div>Contact</div>
            </div>
        </div>                       
    </nav>
    <div class="gpaBox">
        <div class="container">
            <div class="gpaClose">x</div>
            <div class="gpaResult">
                <p>3.75</p>
            </div>
            <div style="display:none" class="gpaDetails gpaResultSection">
                <p>Total Credits : <span id="totCredits">15</span></p>
                <p>Subjects Calculated  : <span id="totSubjects">15</span></p>
                <p>Expected Class: <span id="classExp">1st Class</span></p>
            </div>
            <div class="gpaDetails gpaError">
                <p>Please Select your grades for the subjects that you sat for.</p>
            </div>
        </div>
    </div>
    

    <script>     
        //declarations
        const gpaResultBox = new gpaBox();

        openPage(".home");
        function openPage(page){
            let pages = document.querySelectorAll(".page");
            for (let i = 0; i < pages.length; ++i) {
                pages[i].style.display= "none";
            }

            page = document.querySelector(page);
            page.style.display = "block";

        }

        // Navigation click events (to be completed)
        let navLinks = document.querySelectorAll(".navbar .item");        
        navLinks.forEach(function(link){            
            link.addEventListener("click",function(e){
                let attr = e.currentTarget.getAttribute('name');                
                if(attr !== "calc"){
                    openPage("." + attr);
                    navLinks.forEach(function(item){
                        item.classList.remove("active");
                    });
                    e.currentTarget.classList.add("active");
                }else{
                    if(!gpaResultBox.status){
                        gpaResultBox.open();
                        calculateGpa();
                    }else{
                        gpaResultBox.close();
                    }
                }
            });
        });
        

        //Custom Grades Prompt
        let clickedSub; //the sebject that was clicked to changed
        function GradesPrompt(){

            this.render = function(e){
                // Displays the Grades Prompt
                document.querySelector(".gradesPrompt").style.display = "flex";
                document.querySelector(".dialogOverlay").style.display = "block";
                clickedSub = e;
            }

            this.close = function(){
                document.querySelector(".gradesPrompt").style.display = "none";
                document.querySelector(".dialogOverlay").style.display = "none";
            }
            
        }
        
        //Closes Grades Prompt when the Close button or the Overlay is clicked on
        var Prompt = new GradesPrompt();

        const closeBtns = document.querySelectorAll(".dialogOverlay, .promptClose");

        closeBtns.forEach(function(closeBtn){
            closeBtn.addEventListener("click",function(e){
                Prompt.close();
            });
        });        

        // Changes the Values of the SELECT button when a result is chosen
        const gradeBtns = document.querySelectorAll(".grades .grade");
        gradeBtns.forEach(function(gradeBtn){
            gradeBtn.addEventListener("click",function(e){
                let grade = e.target.innerHTML;
                let gpv = e.target.getAttribute("data_gpv");
                clickedSub.target.innerHTML = grade;
                clickedSub.target.setAttribute("data_gpv",gpv);
                Prompt.close();
            });
        });


        //Once the Body Loads
        const body = document.querySelector("body");

        body.onload = function(){
            //loads the list of subjects
            getSubjects().then((data) => {
                let subjectSrting = ""; //initialize variable that holds the html of all the subjects semester wise

                // loops around each semester                
                data.forEach(function(semester){                    
                    
                    subjectSrting += "<div class='semester'> <div class='title yearTitle'>"+ semester.year +"</div> <div class='title semesterTitle'>"+ semester.semester +"</div>";

                    // loops around each subject for each semester
                    semester.subjects.forEach(function (subject){
                        let dis = ""
                        if(subject.type != "C"){
                            dis = "disabledSub";
                        }
                        subjectSrting += "<div class='subject "+dis+"'> <div class='sub'><span class='code'>" + subject.code + "</span><span class='name'>" + subject.name + "</span></div> <div class='subCredits'><span class='cred'>" + subject.cred + "</span><span class='tooltip ttcredit'>Credit Value</span></div> <div class='attempt'> <input type='checkbox' id='" + subject.code + "' checked><label for='" + subject.code + "'>1st<span class='tooltip ttattempt'>Attempt</span></label> </div> <button type='button' data_gpv='-1'  class='subResult'>SELECT</button> </div>";
                    });                    
                    
                    
                    subjectSrting += "</div>";
                    
                });                
                
                let form = document.querySelector(".home form");
                form.innerHTML = subjectSrting;
                
                //Opens Grades Prompt for each SELECT Button when Clicked
                const resultBtns = document.querySelectorAll(".subResult");

                resultBtns.forEach(function(resultBtn){
                    resultBtn.addEventListener("click",function(e){
                        Prompt.render(e);
                    });
                });

                const checkboxes = document.querySelectorAll(".attempt");
                
                checkboxes.forEach(function(check){
                    check.addEventListener("click",function(e){
                        if(!e.currentTarget.querySelector("input").checked){
                            e.currentTarget.querySelector("label").innerHTML = "2ND";
                        }else{
                            e.currentTarget.querySelector("label").innerHTML = "1ST";
                        }
                    });
                });
            })
        }
        
        //Object and controls for GPA result Box
        function gpaBox () {
            this.object = document.querySelector(".gpaBox");
            this.status = false;           

            this.open = function(){ 
                this.object.style.display = "block";
                this.status =  true;
            },
            this.close = function(){
                this.object.style.display = "none";
                this.status = false;
            }
        }
        //Event listener for click on the gpaResultBox close Btn
        const gpaClose = document.querySelectorAll(".gpaClose");
        gpaClose.forEach(function(closeBtn){
            closeBtn.addEventListener("click",function(e){
                gpaResultBox.close();
            });
        });     

        function calculateGpa(){
            let subjects = document.querySelectorAll(".subject:not(.disabledSub)");
            // subjects = subjects.querySelectorAll('.subject');
            // console.log(subjects.length);

            let totCredits = 0;
            let totSubjects = 0;
            let expClass = "";
            let cumGpvCred = 0;
            let gpa = 0.00;
            
            subjects.forEach(function (subject){
                let subCredit = subject.querySelector(".subCredits .cred").innerHTML;
                let resultGpv = subject.querySelector(".subResult").getAttribute("data_gpv");
                let fAttempt = subject.querySelector("input[type='checkbox']").checked;

                // console.log(subCredit + "," + resultGpv + "," + fAttempt);
                //filters out the subjects that were done
                if(resultGpv>=0){
                    //sets the gpv if second attempt
                    if(!fAttempt){
                        if(resultGpv>2){
                            resultGpv = 2;
                        }
                    }
                    totSubjects++;
                    cumGpvCred += (resultGpv * subCredit);
                    totCredits += Number(subCredit);
                }
 
            });
            gpa = cumGpvCred / totCredits;
            // console.log(gpa);
            gpa = Number(Math.round(gpa*100)/100);
            // console.log(gpa);

            //logic for selecting the expected class
            switch(true){
                case (gpa >= 3.5):
                    expClass = "First Class";
                break;
                case (gpa >= 3.25):
                    expClass = "Second Class (Upper Division)";
                break;
                case (gpa >= 3):
                    expClass = "Second Class (Lower Division)";
                break;
                default:
                    expClass = "General";
            }

            if(totSubjects>0){//true if subjects chosen
                //hide or unhide the error section in the dialog
                document.querySelector(".gpaResult").style.display = "flex";
                document.querySelector(".gpaResultSection").style.display = "flex";
                document.querySelector(".gpaError").style.display = "none";
                //displaying class
                document.querySelector(".gpaResult p").innerHTML = gpa;                           
                document.querySelector("#classExp").innerHTML = expClass;
                document.querySelector("#totSubjects").innerHTML = totSubjects;
                document.querySelector("#totCredits").innerHTML = totCredits;
            }else{
                //hide or unhide the error section in the dialog
                document.querySelector(".gpaResult").style.display = "none";
                document.querySelector(".gpaResultSection").style.display = "none";
                document.querySelector(".gpaError").style.display = "flex";
            }
            
            
            
        }
        
        

        //Function that retrieves data from the the subjects.json file
        let page = document.querySelector(".home form");
        const getSubjects = async function() {
            return await fetch("data/subjects.json")
            .then(res => { return res.json() })
            .then(data => { 
                return data;
            })
            .catch(error => console.log(error))
        }

    </script>
</body>
</html>